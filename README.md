# Project Starter
This repository contains the starter code for the **Ensuring Quality Releases** project of the cd1807 Ensuring Quality Releases (Quality Assurance) course taught by Nathan Anderson. 

## Azure Pipeline
## Pre-requisition

To operate on this repo, following actions are required:

* Have an Azure Account
* Install `az cli`
* Login to your Azure account using CLI:

```sh
az login
```

* Build packer images with this [template](/packer/)
* Create a storage account based on this [script](/terraform/environments/test/configure-tfstate-storage-account.sh)
* Add your Azure account to service connection in Azure DevOps project

## Pipeline

Azure pipeline include of 3 stages:

* Build: building infrastructure using Terraform and publish artifact for later stages
* Deploy: deploying Fake Rest API to Azure App Service using ZIP Deployment
* Test: running 3 test suites including: Postman/Newman, JMeter, Selenium

## Monitoring configuration

### App Service Alert

Following this [document](https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-overview) to create alert for Azure App Services.

### Log Analytics for VM

Following this [document](https://learn.microsoft.com/en-us/azure/azure-monitor/agents/data-sources-custom-logs) to create Custom Logs for VM. Please be patient while waiting for logs to be ingested to Log Analytics

## Results
* output of Terraform when executed by the CI/CD pipeline
![Terraform](img/terraform_pipeline_run_success.png)

* the successful execution of the pipeline
![AzurePipeline](img/pipeline_run_success.png)

* Test Run Results from Postman shown in Azure DevOps
![alt text](img/Test_Result_Pipeline.png)
![alt text](img/newman_test_sum.png)
![alt text](img/postman_data_val_test.png)
![alt text](img/postman_regression_test.png)

* Successful execution of the Test Suite on a VM in Azure DevOps
![alt text](img/selenium_test.png)

* HTML report generated by JMeter. A screenshot of the log output of JMeter when executed by the CI/CD pipeline
![HTMLReport](img/jmeter_report.png)
![HTMLReport](img/jmeter_test.png)

* email received when the alert is triggered (for actual setting using HTTP404 error to trigger would be better - https://en.wikipedia.org/wiki/HTTP_404 - it would able the developer to check the new deployment
![alt text](img/alert_trigger.png)

* alert rule
![alt text](img/AlertRule.png)

* resource, condition, action group, alert name, and severity
![alt text](img/alert_metrics.png)

* resourceâ€™s metrics will correspond to the approximate time that the alert was triggered.
![alt text](img/alert_trigger_cause.png)

* log analytics queries (able to set up the Azure Log Analystic)
![alt text](img/selenium_analystic_logs.png)




